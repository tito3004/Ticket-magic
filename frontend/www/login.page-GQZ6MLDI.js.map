{
  "version": 3,
  "sources": ["src/app/components-user/login/login.page.ts", "src/app/components-user/login/login.page.html"],
  "sourcesContent": ["// Login de usuarios: formulario, validaciones y autenticación contra el backend\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { AuthService, ApiResponse } from '../../services/auth.service';\n\n@Component({\n  selector: 'app-login',\n  standalone: true,\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.css'],\n  imports: [CommonModule, FormsModule, IonicModule, ReactiveFormsModule],\n})\nexport class LoginPage {\n  usuariosForm: FormGroup; // formulario reactivo\n\n  constructor(\n    private fb: FormBuilder,\n    private router: Router,\n    private authService: AuthService\n  ) {\n    // campos y validaciones básicas\n    this.usuariosForm = this.fb.group({\n      correo: [\n        '',\n        [\n          Validators.required,\n          Validators.email,\n          Validators.minLength(6),\n          Validators.maxLength(254),\n          Validators.pattern(/^[a-zA-Z0-9._%+-]{2,64}@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/)\n        ]\n      ],\n      password: ['', [Validators.required, Validators.minLength(6)]]\n    });\n  }\n\n  // intenta iniciar sesión\n  login() {\n    if (!this.usuariosForm.valid) {\n      alert('Por favor, completa todos los campos correctamente.');\n      return;\n    }\n\n    this.authService.login(this.usuariosForm.value).subscribe({\n      next: (resp: ApiResponse) => {\n        if (resp?.status !== false && resp?.token) {\n          // normaliza token (puede venir como string o string[])\n          const raw: unknown = resp.token as any;\n          const token = Array.isArray(raw) ? raw.join('.') : (raw as string);\n\n          if (!token) {\n            alert('Token vacío o inválido.');\n            return;\n          }\n\n          // guarda token y usuario\n          localStorage.setItem('token', token);\n          if (resp.usuario) {\n            localStorage.setItem('usuario', JSON.stringify(resp.usuario));\n          }\n\n          this.usuariosForm.reset();\n          alert('Has iniciado sesión correctamente');\n          this.router.navigate(['/tabs-user/explorar']);\n        } else {\n          alert(resp?.message || 'Respuesta inesperada del servidor.');\n        }\n      },\n      error: (err) => {\n        console.error('Error al iniciar sesión:', err);\n        const backendMessage = err?.error?.message || 'Error desconocido en el servidor.';\n        alert(backendMessage);\n      }\n    });\n  }\n\n  // ir a registro\n  irARegistro(): void {\n    this.router.navigate(['/register']);\n  }\n}\n", "<ion-content class=\"login-page\">\n  <div class=\"login-wrapper\">\n    <div class=\"login-box\">\n      <h1 class=\"brand\">TICKETMAGIC</h1>\n      <form [formGroup]=\"usuariosForm\" (ngSubmit)=\"login()\">\n      <ion-input\n        class=\"login-input\"\n        placeholder=\"Correo electrónico...\"\n        type=\"email\"\n        fill=\"solid\"\n        formControlName=\"correo\">\n      </ion-input>\n\n      <ion-input\n        class=\"login-input\"\n        placeholder=\"Contraseña...\"\n        type=\"password\"\n        fill=\"solid\"\n        formControlName=\"password\">\n      </ion-input>\n      <ion-button expand=\"block\" class=\"login-button\" type=\"submit\">INICIAR SESIÓN</ion-button>\n    </form>\n      <p class=\"texto-link-recuperar\"><a class=\"texto-link\" href=\"/recuperar\">¿Olvidaste tu contraseña?</a></p>\n      <p class=\"texto-link\">\n  ¿No tienes cuenta?\n  <a (click)=\"irARegistro()\">Crear cuenta</a>\n</p>\n    </div>\n  </div>\n</ion-content>\n"],
  "mappings": "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",
  "names": []
}
