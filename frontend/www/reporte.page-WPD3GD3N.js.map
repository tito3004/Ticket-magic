{
  "version": 3,
  "sources": ["src/app/components-admin/reporte/reporte.page.ts", "src/app/components-admin/reporte/reporte.page.html"],
  "sourcesContent": ["// Página para comprobar un código de boleto y mostrar su resumen\nimport { Component, OnInit, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { UsersService, CompraResumen } from 'src/app/services/users.service';\n\n@Component({\n  selector: 'app-reporte',\n  standalone: true,\n  imports: [CommonModule, FormsModule, IonicModule],\n  templateUrl: './reporte.page.html',\n  styleUrls: ['./reporte.page.css']\n})\nexport class ReportePage implements OnInit {\n  private route = inject(ActivatedRoute);\n  private router = inject(Router);\n  private usersSvc = inject(UsersService);\n\n  codigo = '';      // código ingresado o leído de la URL\n  loading = false;  // evita llamadas dobles\n\n  // si viene ?cod-unico-boleto=... en la URL, lo procesa\n  ngOnInit() {\n    this.route.queryParamMap.subscribe((qp) => {\n      const cod = qp.get('cod-unico-boleto');\n      if (cod && cod.trim()) {\n        this.codigo = cod.trim();\n        this.verificarYAlertar(this.codigo);\n      }\n    });\n  }\n\n  // botón \"comprobar\": valida y refresca la URL con el código\n  comprobarCodigo() {\n    if (!this.codigo?.trim()) {\n      alert('Código requerido\\nIngresa un código para comprobar.');\n      return;\n    }\n\n    this.router.navigate([], {\n      relativeTo: this.route,\n      queryParams: { 'cod-unico-boleto': this.codigo.trim() },\n      queryParamsHandling: 'merge'\n    });\n  }\n\n  // consulta a la API y muestra el resultado en un alert()\n  private verificarYAlertar(cod: string) {\n    if (this.loading) return;\n    this.loading = true;\n\n    this.usersSvc.getResumenPorCodigo(cod).subscribe({\n      next: (resp) => {\n        this.loading = false;\n\n        if (!resp?.status) {\n          alert(`No encontrado\\n${resp?.message || 'No se encontró información para ese código.'}`);\n          return;\n        }\n\n        const rows = (resp.data ?? []) as CompraResumen[];\n        if (!rows.length) {\n          alert('Sin datos\\nNo hay registros para ese código.');\n          return;\n        }\n\n        const r = rows[0];\n        const horaFormateada = r.hora ? r.hora.toString().slice(0, 5) : '';\n        const msg =\n          `Evento: ${r.nombre_evento}\\n` +\n          `Fecha: ${r.fecha}\\n` +\n          `Hora: ${horaFormateada}\\n` +\n          `Cantidad: ${r.cantidad}\\n` +\n          `Código: ${r.cod_unico_boleto}`;\n\n        alert(msg);\n      },\n      error: () => {\n        this.loading = false;\n        alert('Error\\nNo se pudo verificar el código.');\n      }\n    });\n  }\n\n  // placeholder del escáner (por integrar)\n  abrirCamara() {\n    alert('Integración de escáner pendiente.');\n  }\n}\n", "<ion-content class=\"fondo-oscuro\">\n  <div class=\"contenedor-formulario\">\n    <div class=\"formulario\">\n      <h2 class=\"titulo\">Compruebe su código QR</h2>\n\n      <ion-item class=\"qr-item\" fill=\"outline\" lines=\"none\">\n        <ion-input\n          placeholder=\"Código\"\n          [(ngModel)]=\"codigo\"\n          (keyup.enter)=\"comprobarCodigo()\">\n        </ion-input>\n\n        <!-- Botón de cámara (placeholder por ahora) -->\n        <ion-button slot=\"end\" class=\"qr-camera\" fill=\"clear\" aria-label=\"Abrir cámara\" (click)=\"abrirCamara()\">\n          <ion-icon name=\"camera-outline\"></ion-icon>\n        </ion-button>\n      </ion-item>\n\n      <ion-button expand=\"block\" (click)=\"comprobarCodigo()\">COMPROBAR</ion-button>\n    </div>\n  </div>\n</ion-content>\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeM,IAAO,eAAP,MAAO,aAAW;EAPxB,cAAA;AAQU,SAAA,QAAQ,OAAO,cAAc;AAC7B,SAAA,SAAS,OAAO,MAAM;AACtB,SAAA,WAAW,OAAO,YAAY;AAEtC,SAAA,SAAS;AACT,SAAA,UAAU;;;EAGV,WAAQ;AACN,SAAK,MAAM,cAAc,UAAU,CAAC,OAAM;AACxC,YAAM,MAAM,GAAG,IAAI,kBAAkB;AACrC,UAAI,OAAO,IAAI,KAAI,GAAI;AACrB,aAAK,SAAS,IAAI,KAAI;AACtB,aAAK,kBAAkB,KAAK,MAAM;MACpC;IACF,CAAC;EACH;;EAGA,kBAAe;AACb,QAAI,CAAC,KAAK,QAAQ,KAAI,GAAI;AACxB,YAAM,2DAAqD;AAC3D;IACF;AAEA,SAAK,OAAO,SAAS,CAAA,GAAI;MACvB,YAAY,KAAK;MACjB,aAAa,EAAE,oBAAoB,KAAK,OAAO,KAAI,EAAE;MACrD,qBAAqB;KACtB;EACH;;EAGQ,kBAAkB,KAAW;AACnC,QAAI,KAAK;AAAS;AAClB,SAAK,UAAU;AAEf,SAAK,SAAS,oBAAoB,GAAG,EAAE,UAAU;MAC/C,MAAM,CAAC,SAAQ;AACb,aAAK,UAAU;AAEf,YAAI,CAAC,MAAM,QAAQ;AACjB,gBAAM;EAAkB,MAAM,WAAW,sDAA6C,EAAE;AACxF;QACF;AAEA,cAAM,OAAQ,KAAK,QAAQ,CAAA;AAC3B,YAAI,CAAC,KAAK,QAAQ;AAChB,gBAAM,iDAA8C;AACpD;QACF;AAEA,cAAM,IAAI,KAAK,CAAC;AAChB,cAAM,iBAAiB,EAAE,OAAO,EAAE,KAAK,SAAQ,EAAG,MAAM,GAAG,CAAC,IAAI;AAChE,cAAM,MACJ,WAAW,EAAE,aAAa;SAChB,EAAE,KAAK;QACR,cAAc;YACV,EAAE,QAAQ;aACZ,EAAE,gBAAgB;AAE/B,cAAM,GAAG;MACX;MACA,OAAO,MAAK;AACV,aAAK,UAAU;AACf,cAAM,2CAAwC;MAChD;KACD;EACH;;EAGA,cAAW;AACT,UAAM,yCAAmC;EAC3C;;;mCA1EW,cAAW;AAAA;6EAAX,cAAW,WAAA,CAAA,CAAA,aAAA,CAAA,GAAA,OAAA,IAAA,MAAA,GAAA,QAAA,CAAA,CAAA,GAAA,cAAA,GAAA,CAAA,GAAA,uBAAA,GAAA,CAAA,GAAA,YAAA,GAAA,CAAA,GAAA,QAAA,GAAA,CAAA,QAAA,WAAA,SAAA,QAAA,GAAA,SAAA,GAAA,CAAA,eAAA,aAAA,GAAA,iBAAA,eAAA,SAAA,GAAA,CAAA,QAAA,OAAA,QAAA,SAAA,cAAA,mBAAA,GAAA,aAAA,GAAA,OAAA,GAAA,CAAA,QAAA,gBAAA,GAAA,CAAA,UAAA,SAAA,GAAA,OAAA,CAAA,GAAA,UAAA,SAAA,qBAAA,IAAA,KAAA;AAAA,MAAA,KAAA,GAAA;ACfxB,IAAA,yBAAA,GAAA,eAAA,CAAA,EAAkC,GAAA,OAAA,CAAA,EACG,GAAA,OAAA,CAAA,EACT,GAAA,MAAA,CAAA;AACH,IAAA,iBAAA,GAAA,2BAAA;AAAsB,IAAA,uBAAA;AAEzC,IAAA,yBAAA,GAAA,YAAA,CAAA,EAAsD,GAAA,aAAA,CAAA;AAGlD,IAAA,2BAAA,iBAAA,SAAA,wDAAA,QAAA;AAAA,MAAA,6BAAA,IAAA,QAAA,MAAA,MAAA,IAAA,SAAA;AAAA,aAAA;IAAA,CAAA;AACA,IAAA,qBAAA,eAAA,SAAA,wDAAA;AAAA,aAAe,IAAA,gBAAA;IAAiB,CAAA;AAClC,IAAA,uBAAA;AAGA,IAAA,yBAAA,GAAA,cAAA,CAAA;AAAgF,IAAA,qBAAA,SAAA,SAAA,mDAAA;AAAA,aAAS,IAAA,YAAA;IAAa,CAAA;AACpG,IAAA,oBAAA,GAAA,YAAA,CAAA;AACF,IAAA,uBAAA,EAAa;AAGf,IAAA,yBAAA,GAAA,cAAA,CAAA;AAA2B,IAAA,qBAAA,SAAA,SAAA,mDAAA;AAAA,aAAS,IAAA,gBAAA;IAAiB,CAAA;AAAE,IAAA,iBAAA,IAAA,WAAA;AAAS,IAAA,uBAAA,EAAa,EACzE,EACF;;;AAZE,IAAA,oBAAA,CAAA;AAAA,IAAA,2BAAA,WAAA,IAAA,MAAA;;kBDGE,cAAc,aAAW,iBAAA,SAAE,aAAW,WAAA,YAAA,SAAA,UAAA,SAAA,0BAAA,GAAA,QAAA,CAAA,owDAAA,EAAA,CAAA;AAI5C,IAAO,cAAP;;sEAAO,aAAW,CAAA;UAPvB;uBACW,eAAa,YACX,MAAI,SACP,CAAC,cAAc,aAAa,WAAW,GAAC,UAAA,sxBAAA,QAAA,CAAA,0hDAAA,EAAA,CAAA;;;;6EAItC,aAAW,EAAA,WAAA,eAAA,UAAA,oDAAA,YAAA,GAAA,CAAA;AAAA,GAAA;",
  "names": []
}
