{
  "version": 3,
  "sources": ["src/app/components-user/historial/historial.page.ts", "src/app/components-user/historial/historial.page.html"],
  "sourcesContent": ["// Historial: muestra los boletos comprados por el usuario con su QR y enlace de verificación\nimport { Component, OnInit, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { UsersService, CompraResumen } from 'src/app/services/users.service';\nimport { environment } from 'src/environments/environment';\nimport { ActivatedRoute, Router } from '@angular/router';\n\ninterface BoletoVM {\n  evento: string;\n  fecha: string;\n  hora: string;\n  id: string;\n  cantidad: number;\n  link: string;\n  qr: string;\n}\n\n@Component({\n  selector: 'app-historial',\n  standalone: true,\n  imports: [CommonModule, IonicModule],\n  templateUrl: './historial.page.html',\n  styleUrls: ['./historial.page.css'],\n})\nexport class HistorialPage implements OnInit {\n  boletos: BoletoVM[] = [];\n  loading = false;\n\n  appBaseUrl = (environment as any).webAppBaseUrl ?? window.location.origin;\n\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private UsersService: UsersService\n  ) {}\n\n  ngOnInit() {\n    this.cargar();\n  }\n\n  cargar(event?: any) {\n    this.loading = true;\n\n    this.UsersService.getResumenPorUsuario().subscribe({\n      next: async (resp) => {\n        this.loading = false;\n        event?.target?.complete?.();\n\n        if (!resp.status) {\n          alert();\n          return;\n        }\n\n        const rows = (resp.data ?? []) as CompraResumen[];\n        this.boletos = rows.map((r) => {\n          const link = `${this.appBaseUrl}/tabs-admin/comprobar?cod-unico-boleto=${encodeURIComponent(r.cod_unico_boleto)}`;\n          const qr = `https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=${encodeURIComponent(link)}`;\n\n          return {\n            evento: r.nombre_evento,\n            fecha: String(r.fecha),\n            hora: String(r.hora),\n            id: r.cod_unico_boleto,\n            cantidad: r.cantidad,\n            link,\n            qr\n          };\n        });\n      },\n      error: async () => {\n        this.loading = false;\n        event?.target?.complete?.();\n        alert('Error al cargar el historial');\n      }\n    });\n  }\n\n  trackByCod(_: number, b: BoletoVM) {\n    return b.id;\n  }\n}\n", "<ion-header>\n\n</ion-header>\n\n<ion-content [fullscreen]=\"true\" class=\"ion-padding\">\n  <div  class=\"historial-title\">\n    <h1>Historial de boletos</h1>\n  </div>\n\n  <div class=\"tarjetas-container\">\n    <div class=\"tarjeta-boleto\" *ngFor=\"let boleto of boletos\">\n      <div class=\"contenido-boleto\">\n        <h2>{{ boleto.evento }}</h2>\n        <p class=\"fecha\">{{ boleto.fecha }} • {{ boleto.hora }}</p>\n        <img [src]=\"boleto.qr\" alt=\"Código QR\" class=\"qr-img\" />\n        <p class=\"id\">ID: {{ boleto.id }}</p>\n      </div>\n    </div>\n  </div>\n</ion-content>\n"],
  "mappings": "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",
  "names": ["UsersService"]
}
