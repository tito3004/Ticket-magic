{
  "version": 3,
  "sources": ["src/app/components-user/calendario/calendario.page.ts", "src/app/components-user/calendario/calendario.page.html"],
  "sourcesContent": ["// Calendario (usuario): muestra tus eventos comprados en FullCalendar\nimport { Component, OnInit, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FullCalendarModule } from '@fullcalendar/angular';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport { CalendarOptions, EventInput } from '@fullcalendar/core';\nimport { UsersService, CompraResumen } from 'src/app/services/users.service';\n\n@Component({\n  selector: 'app-calendario',\n  standalone: true,\n  imports: [CommonModule, IonicModule, FullCalendarModule],\n  templateUrl: './calendario.page.html',\n  styleUrls: ['./calendario.page.css'],\n})\nexport class CalendarioPage implements OnInit {\n  private usersSvc = inject(UsersService);\n  loading = false;\n\n  // config básica del calendario\n  calendarOptions: CalendarOptions = {\n    plugins: [dayGridPlugin],\n    initialView: 'dayGridMonth',\n    events: [],\n    contentHeight: 'auto',\n    headerToolbar: { left: 'prev,next today', center: 'title', right: '' },\n    eventTimeFormat: { hour: '2-digit', minute: '2-digit', hour12: false }\n  };\n\n  ngOnInit(): void {\n    this.cargarEventos();\n  }\n\n  // pide compras del usuario y las mapea a eventos únicos\n  private cargarEventos(): void {\n    this.loading = true;\n    this.usersSvc.getResumenPorUsuario().subscribe({\n      next: (resp) => {\n        this.loading = false;\n        if (!resp?.status) {\n          alert(resp?.message || 'No se pudo cargar tus eventos');\n          return;\n        }\n\n        const rows = (resp.data ?? []) as CompraResumen[];\n        const uniq = new Map<string, EventInput>(); // dedup por evento-fecha-hora\n\n        for (const r of rows) {\n          const fecha = String(r.fecha);               \n          const hora  = String(r.hora).substring(0, 5);\n          const key   = `${r.nombre_evento}|${fecha}|${hora}`;\n\n          if (!uniq.has(key)) {\n            uniq.set(key, {\n              title: r.nombre_evento,\n              start: `${fecha}T${hora}`,\n            });\n          }\n        }\n\n        const events = Array.from(uniq.values());\n        this.calendarOptions = { ...this.calendarOptions, events }; // trigger refresh\n      },\n      error: () => {\n        this.loading = false;\n        alert('Error al cargar tus eventos');\n      }\n    });\n  }\n}\n", "<ion-header>\n  <ion-toolbar color=\"white\">\n    \n  </ion-toolbar>\n</ion-header>\n\n<ion-content [fullscreen]=\"true\" class=\"ion-padding\">\n\n  <div  class=\"historial-title\">\n    <h1>Tus eventos</h1>\n  </div>\n  <div class=\"calendar-container\">\n    <full-calendar [options]=\"calendarOptions\"></full-calendar>\n  </div>\n</ion-content>\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBM,IAAO,kBAAP,MAAO,gBAAc;EAP3B,cAAA;AAQU,SAAA,WAAW,OAAO,YAAY;AACtC,SAAA,UAAU;AAGV,SAAA,kBAAmC;MACjC,SAAS,CAAC,KAAa;MACvB,aAAa;MACb,QAAQ,CAAA;MACR,eAAe;MACf,eAAe,EAAE,MAAM,mBAAmB,QAAQ,SAAS,OAAO,GAAE;MACpE,iBAAiB,EAAE,MAAM,WAAW,QAAQ,WAAW,QAAQ,MAAK;;;EAGtE,WAAQ;AACN,SAAK,cAAa;EACpB;;EAGQ,gBAAa;AACnB,SAAK,UAAU;AACf,SAAK,SAAS,qBAAoB,EAAG,UAAU;MAC7C,MAAM,CAAC,SAAQ;AACb,aAAK,UAAU;AACf,YAAI,CAAC,MAAM,QAAQ;AACjB,gBAAM,MAAM,WAAW,+BAA+B;AACtD;QACF;AAEA,cAAM,OAAQ,KAAK,QAAQ,CAAA;AAC3B,cAAM,OAAO,oBAAI,IAAG;AAEpB,mBAAW,KAAK,MAAM;AACpB,gBAAM,QAAQ,OAAO,EAAE,KAAK;AAC5B,gBAAM,OAAQ,OAAO,EAAE,IAAI,EAAE,UAAU,GAAG,CAAC;AAC3C,gBAAM,MAAQ,GAAG,EAAE,aAAa,IAAI,KAAK,IAAI,IAAI;AAEjD,cAAI,CAAC,KAAK,IAAI,GAAG,GAAG;AAClB,iBAAK,IAAI,KAAK;cACZ,OAAO,EAAE;cACT,OAAO,GAAG,KAAK,IAAI,IAAI;aACxB;UACH;QACF;AAEA,cAAM,SAAS,MAAM,KAAK,KAAK,OAAM,CAAE;AACvC,aAAK,kBAAkB,iCAAK,KAAK,kBAAV,EAA2B,OAAM;MAC1D;MACA,OAAO,MAAK;AACV,aAAK,UAAU;AACf,cAAM,6BAA6B;MACrC;KACD;EACH;;;mCArDW,iBAAc;AAAA;gFAAd,iBAAc,WAAA,CAAA,CAAA,gBAAA,CAAA,GAAA,OAAA,GAAA,MAAA,GAAA,QAAA,CAAA,CAAA,SAAA,OAAA,GAAA,CAAA,GAAA,eAAA,GAAA,YAAA,GAAA,CAAA,GAAA,iBAAA,GAAA,CAAA,GAAA,oBAAA,GAAA,CAAA,GAAA,SAAA,CAAA,GAAA,UAAA,SAAA,wBAAA,IAAA,KAAA;AAAA,MAAA,KAAA,GAAA;AChB3B,IAAA,yBAAA,GAAA,YAAA;AACE,IAAA,oBAAA,GAAA,eAAA,CAAA;AAGF,IAAA,uBAAA;AAEA,IAAA,yBAAA,GAAA,eAAA,CAAA,EAAqD,GAAA,OAAA,CAAA,EAErB,GAAA,IAAA;AACxB,IAAA,iBAAA,GAAA,aAAA;AAAW,IAAA,uBAAA,EAAK;AAEtB,IAAA,yBAAA,GAAA,OAAA,CAAA;AACE,IAAA,oBAAA,GAAA,iBAAA,CAAA;AACF,IAAA,uBAAA,EAAM;;;AAPK,IAAA,oBAAA,CAAA;AAAA,IAAA,qBAAA,cAAA,IAAA;AAMM,IAAA,oBAAA,CAAA;AAAA,IAAA,qBAAA,WAAA,IAAA,eAAA;;kBDAP,cAAc,aAAW,YAAA,WAAA,YAAE,oBAAkB,qBAAA,GAAA,QAAA,CAAA,mtCAAA,EAAA,CAAA;AAInD,IAAO,iBAAP;;sEAAO,gBAAc,CAAA;UAP1B;uBACW,kBAAgB,YACd,MAAI,SACP,CAAC,cAAc,aAAa,kBAAkB,GAAC,UAAA,wVAAA,QAAA,CAAA,khCAAA,EAAA,CAAA;;;;6EAI7C,gBAAc,EAAA,WAAA,kBAAA,UAAA,yDAAA,YAAA,GAAA,CAAA;AAAA,GAAA;",
  "names": []
}
